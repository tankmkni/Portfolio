<!DOCTYPE html>
<html>
<head><meta charset="utf-8"/>
	<link rel="stylesheet" href="../css/basic.css">
	<script type="text/javascript" src="../js/common.js"></script>
	<title>Rows Counter</title>
</head>
<style>
img,table{width: 75vw;}
img{border: 1px solid silver;}
table table{width: 100%;}
table table th{width: 20%;}
</style>
<body>
<h1>メモ：cmd ファイルの行を取得する</h1>
<div>コマンドプロンプトで、フォルダ内（サブフォルダを含む）の指定した拡張子の全ファイルの行数の合計を求めるバッチファイルを作成したのでその覚え書き</div>
<h4>test.txt</h4>
<iframe src="test.txt" onload="setHeight(this)"></iframe>
<h5>作成方法</h5>
<div>コマンドテキストを作成し、拡張子を「.bat」にして保存すればバッチファイルになる<br/>
     今回は上記テキストを test.bat として保存</div>
<h5>実行方法</h5>
<div>コマンドプロンプトで、カレントディレクトリに対象のバッチファイルがあれば、<br/>
     １・ファイル名.bat + Enter で実行される<br/>
     ２・ファイル名 + Enter でも実行できる</div>
<div>絶対パスか相対パスで呼び出せば、どこのファイルでも実行できる<br/>
     （実行はファイルの配置場所起点なので、コマンドに相対参照があった場合は注意）</div>
<div>コマンドプロンプトを開かなくても、エクスプローラーで直にバッチファイルをダブルクリックしても実行できる</div>
<div>バッチファイルでバッチファイルを呼び出すことも可能なよう</div>
<span>test.bat をダブルクリックする</span><br/>
<img src="img/folder.png"><br/>
<span>コマンドプロンプトが自動的に立ち上がり実行される</span><br/>
<img src="img/cmd.png"><br/>
<span>バッチファイルに記載したとおりに、条件にあったファイル数とその行の合計数が表示されている<br/>
      pause を記載しているので、何か押されるまで待機している<br/>
      何かを押すと、自動的にコマンドプロンプトが終了される</span>
<h5>コマンドについて</h5>
<table border="2">
<tr><th>コマンド</th><th>メモ</th></tr>
<tr><th><code>@echo off</code></th><td>経過を表示しない</td></tr>
<tr><th><code>rem</code></th><td>コメントアウト</td></tr>
<tr><th><code>set</code></th>
<td>環境変数の参照/設定/削除<table border="1">
<tr><th>書式</th><td><code>SET [変数名=[文字列]]</code></td></tr>
<tr><th><code>%変数名%</code></th><td>変数の参照は、「%」 で挟む</td></tr>
<tr><th><code>/a</code></th><td>計算時のオプション</td></tr>
</table></td></tr>
<tr><th><code>for</code></th>
<td>ループ<table border="1">
<tr><th>書式</th><td><code>for "オプション" %%変数 in ("条件式") do コマンド</code><br/>
                     変数はアルファベット１文字</td></tr>
<tr><th><code>/f</code></th><td>ファイル内容を1行ずつ読み込むオプション</td></tr>
<tr><th><code>%%変数</code></th><td>バッチファイルに記載する時は<br/>変数は記載・参照共に "%%" は２つ</td></tr>
<tr><th><code>%変数</code></th><td>コマンドプロンプトに直に記載する時は<br/>変数は記載・参照共に "%" は１つ</td></tr>
<tr><th><code>('…')</code></th><td>条件式にコマンドを使う場合は<br/>「 ' 」 (クォーテーション)で挟む</td></tr>
<tr><th><code>do ( … )</code></th><td>do の後に()をつけると<br/>コマンドを複数行に分けて記述できる</td></tr>
<tr><th><code>('…^|…')</code></th>
<td>条件式のコマンドに「|」を使う場合<br/>
    「^」を付ける必要がある</td>
</table></td></tr>
<tr><th><code>dir</code></th><td>フォルダの表示<table border="1">
<tr><th>書式</th><td></td></tr>
<tr><th><code>/a-d</code></th><td></td></tr>
<tr><th><code>/b</code></th><td></td></tr>
<tr><th><code>/s</code></th><td></td></tr>
</table></td></tr>
<tr><th><code>find</code></th><td>ファイル内の検索<table border="1">
<tr><th>書式</th><td></td></tr>
<tr><th><code>/c</code></th><td></td></tr>
<tr><th><code>/v</code></th><td></td></tr>
<tr><th></th><td></td></tr>
</table></td></tr></td></tr>
<tr><th><code>echo</code></th><td>表示<table border="1">
<tr><th></th><td></td></tr>
<tr><th></th><td></td></tr>
<tr><th></th><td></td></tr>
<tr><th></th><td></td></tr>
</table></td></tr></td></tr>
<tr><th><code>type</code></th><td>ファイルの一覧表示<table border="1">
<tr><th>書式</th><td></td></tr>
<tr><th></th><td></td></tr>
<tr><th></th><td></td></tr>
<tr><th></th><td></td></tr>
</table></td></tr></td></tr>
<tr><th><code>pause</code></th><td>何かキーが押されるまで待機</td></tr>
<tr><th><code>exit</code></th><td>終了<table border="1">
<tr><th></th><td></td></tr>
<tr><th><code>/b</code></th><td></td></tr>
<tr><th><code>0</code></th><td></td></tr>
<tr><th></th><td></td></tr>
</table></td></tr></td>
<tr><th><code>|</code></th><td>パイプ コマンドの出力を別のコマンドの入力として渡す</td>
<tr><th><code>^</code></th>
<td>ハット記号(サーカムフレックス; カレットとも)<br/>
    エスケープ コマンド途中での改行などに使える</td>
</tr>

</table>




<p>参考になったサイト</p><div>
<a href="https://www.doraxdora.com/blog/2017/04/27/post-353/">ファイルの行数をカウントするバッチを作ってみた。</a><br/>
<a href="http://capm-network.com/?tag=Windows%E3%83%90%E3%83%83%E3%83%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%A8%E5%AE%9F%E8%A1%8C">Windowsバッチファイルの作成と実行</a><br/>
<a href="https://qiita.com/plcherrim/items/67be34bab1fdf3fb87f9">.bat（バッチファイル）のforコマンド解説。</a><br/>
<a href="https://jj-blues.com/cms/wantto-calculationinbatfile/">バッチファイル内で計算を行う</a><br/>
<a href="https://www.javadrive.jp/command/redirect/index2.html">リダイレクトでファイルへ出力するときに追加書き込みを行う</a><br/>
<a href="https://www.rootlinks.net/2014/02/14/%E3%83%90%E3%83%83%E3%83%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AEfor%E3%83%AB%E3%83%BC%E3%83%97%E5%86%85%E3%81%A7%E5%A4%89%E6%95%B0%E3%82%92%E6%89%B1%E3%81%86/">バッチファイルのforループ内で変数を扱う</a><br/>
<a href="https://qiita.com/hidekuro/items/dd68e15567cdce2828bd">コマンドプロンプトのmkdirで「既に存在する場合は何もしない」</a><br/>
<a href="https://www.k-tanaka.net/cmd/dir.php">dir ファイル・ディレクトリの情報を表示する</a><br/>
<a href="https://qiita.com/RagWork/items/d8c404cba9d204a719c3">【Windowsバッチ】コマンド実行結果を環境変数に代入する方法</a><br/>
<a href="https://www.javadrive.jp/command/command/index4.html">環境変数の値の参照と設定(SET)</a><br/>
<a href="https://www.javadrive.jp/command/bat/index9.html">バッチファイルで繰り返し処理を使う(FOR)</a><br/>
<a href=""></a><br/>
<a href=""></a><br/>
</div>
<button onclick="history.back()">戻る</button>
<br/><br/><br/>
<br/><br/><br/>
</body>
</html>
